[supervisord]
nodaemon = true
environment =
    DJANGO_SETTINGS_MODULE='baserow.config.settings.base',
    DATABASE_HOST='localhost',
    DATABASE_PASSWORD='{{baserow_db_password}}',
    SECRET_KEY='{{baserow_secret_key}}',
    PRIVATE_BACKEND_URL='http://localhost:8000',
    PUBLIC_WEB_FRONTEND_URL='https://{{baserow_dns_frontend}}',
    PUBLIC_BACKEND_URL='https://{{baserow_dns_api}}',
    MEDIA_ROOT='{{baserow_base_path}}/media',
    MEDIA_URL='https://{{baserow_dns_media}}/',
    REDIS_HOST='localhost'

[program:gunicorn]
command = {{baserow_venv_path}}/env/bin/gunicorn -w 5 -b 127.0.0.1:8000 -k uvicorn.workers.UvicornWorker baserow.config.asgi:application --log-level=debug --chdir={{baserow_base_path}}
stdout_logfile=/var/log/baserow/backend.log
stderr_logfile=/var/log/baserow/backend.error

[program:worker]
directory={{baserow_base_path}}
command = {{baserow_venv_path}}/env/bin/celery -A baserow worker -l INFO
stdout_logfile=/var/log/baserow/worker.log
stderr_logfile=/var/log/baserow/worker.error
